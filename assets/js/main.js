
// Language translations
const translations = {
  en: {
    topBanner: "TEST MODE — All payment links are for testing purposes only",
    logoText: "Reviews Request Machine",
    navPackages: "Packages",
    navHowItWorks: "How it works",
    navCompliance: "Compliance",
    navFaq: "FAQs",
    navContact: "Contact",
    heroTitle: "Google Reviews Request Machine (EN/ES) — Compliant, 48h Setup",
    heroSubtitle: "Turn last month's happy customers into honest Google reviews—no incentives, no gating.",
    heroBtnStarter: "Get Starter – $99",
    heroBtnStandard: "Standard – $199",
    heroBtnPro: "Rush/Pro – $299",
    heroOnboarding: "You'll complete a 3-minute onboarding after checkout.",
    socialProofTitle: "Trusted by Businesses",
    socialProofSubtitle: "See what our clients have to say about our service",
    testimonial1: "The review request service helped us increase our Google reviews by 40% in just one month. Completely compliant and professional.",
    testimonial1Author: "— Restaurant Owner",
    testimonial2: "Bilingual support was exactly what we needed. Our Spanish-speaking customers now leave reviews just as often as English speakers.",
    testimonial2Author: "— Retail Manager",
    testimonial3: "Setup was incredibly fast. We were up and running in less than 48 hours, and the weekly reports are very helpful.",
    testimonial3Author: "— Service Provider",
    packagesTitle: "Choose Your Package",
    packagesSubtitle: "One-time setup for ongoing Google review requests",
    packageStarterTitle: "Starter",
    packageStarterFeature1: "Up to 100 review requests",
    packageStarterFeature2: "English or Spanish emails",
    packageStarterFeature3: "Weekly summary reports",
    packageStarterFeature4: "48-hour setup",
    packageStarterBtn: "Buy Starter",
    packageStandardTitle: "Standard",
    packageStandardFeature1: "Up to 500 review requests",
    packageStandardFeature2: "Bilingual emails (EN + ES)",
    packageStandardFeature3: "Weekly summary reports",
    packageStandardFeature4: "Custom email templates",
    packageStandardFeature5: "48-hour setup",
    packageStandardBtn: "Buy Standard",
    packageProTitle: "Rush/Pro",
    packageProFeature1: "Unlimited review requests",
    packageProFeature2: "Bilingual emails (EN + ES)",
    packageProFeature3: "Daily summary reports",
    packageProFeature4: "Custom email templates",
    packageProFeature5: "24-hour rush setup",
    packageProBtn: "Buy Rush/Pro",
    howItWorksTitle: "How It Works",
    howItWorksSubtitle: "Simple process to get more Google reviews",
    step1Title: "Buy + Onboarding",
    step1Description: "Choose your package and complete our simple 3-minute onboarding process.",
    step2Title: "We Send Requests",
    step2Description: "We send personalized review requests to your customers with polite reminders.",
    step3Title: "Get Results",
    step3Description: "Receive weekly summary reports with your new review count and insights.",
    complianceTitle: "Fully Compliant",
    complianceSubtitle: "We follow Google's review policies strictly",
    complianceNoIncentives: "No incentives",
    complianceNoGating: "No review gating",
    complianceAllCustomers: "We ask all recent customers",
    complianceOptOut: "Clear opt-out in every email",
    complianceNote: "We only use consented lists provided by you. All emails can be in English, Spanish, or both languages.",
    complianceGooglePolicy: "Google prohibits incentivized or gated reviews; we comply fully with all policies.",
    faqTitle: "Frequently Asked Questions",
    faqSubtitle: "Everything you need to know about our service",
    faqQuestion1: "Is this service compliant with Google's policies?",
    faqAnswer1: "Yes, we strictly follow Google's review policies. We never offer incentives for reviews, we don't gate reviews (only asking happy customers), and we include a clear opt-out in every email. We ask all recent customers, not just those likely to leave positive reviews.",
    faqQuestion2: "How quickly can I get started?",
    faqAnswer2: "We launch within 48 hours after you complete the onboarding process. For our Rush/Pro package, we can set everything up within 24 hours. The onboarding itself takes only about 3 minutes to complete.",
    faqQuestion3: "What do I need to provide?",
    faqAnswer3: "You'll need to provide your Google review link or QR code, a consented contact list of recent customers, your preferred sender address, and your logo/brand tone if you want custom email templates.",
    faqQuestion4: "How is customer data handled?",
    faqAnswer4: "We take data privacy seriously. Customer information is used only for sending review requests and is deleted after 30 days. We never share or sell customer data to third parties.",
    faqQuestion5: "What email domain will be used?",
    faqAnswer5: "We can send emails from your domain or from our system domain. Using your domain typically results in higher open rates but requires some simple DNS configuration. We'll guide you through this process during onboarding.",
    faqQuestion6: "What kind of results can I expect?",
    faqAnswer6: "Results vary based on your customer relationships and industry, but our clients typically see a 20-40% increase in Google reviews within the first month. The bilingual approach often yields even better results for businesses with Spanish-speaking customers.",
    contactTitle: "Ready to Get Started?",
    contactSubtitle: "Have questions? Reach out to our team",
    contactEmail: "Email Us",
    contactOnboarding: "Start Onboarding",
    contactTestNote: "Note: The Stripe links above are for testing purposes only. No actual charges will be made.",
    footerAbout: "About Us",
    footerAboutText: "We help businesses get more Google reviews through compliant, bilingual email requests.",
    footerQuickLinks: "Quick Links",
    footerPackages: "Packages",
    footerHowItWorks: "How It Works",
    footerCompliance: "Compliance",
    footerFaq: "FAQ",
    footerContact: "Contact",
    footerEmail: "info@reviewsrequestmachine.com",
    footerComplianceNote: "Google prohibits incentivized or gated reviews; we comply fully."
  },
  es: {
    topBanner: "MODO DE PRUEBA — Todos los enlaces de pago son solo para fines de prueba",
    logoText: "Máquina de Solicitud de Reseñas",
    navPackages: "Paquetes",
    navHowItWorks: "Cómo funciona",
    navCompliance: "Cumplimiento",
    navFaq: "Preguntas",
    navContact: "Contacto",
    heroTitle: "Máquina de Solicitud de Reseñas de Google (EN/ES) — Cumplimiento, Configuración en 48h",
    heroSubtitle: "Convierte a los clientes felices del mes pasado en reseñas honestas de Google: sin incentivos, sin filtrar.",
    heroBtnStarter: "Obtener Starter – $99",
    heroBtnStandard: "Estándar – $199",
    heroBtnPro: "Rápido/Pro – $299",
    heroOnboarding: "Completarás un proceso de incorporación de 3 minutos después del pago.",
    socialProofTitle: "Confiable para Empresas",
    socialProofSubtitle: "Vea lo que nuestros clientes dicen sobre nuestro servicio",
    testimonial1: "El servicio de solicitud de reseñas nos ayudó a aumentar nuestras reseñas de Google en un 40% en solo un mes. Totalmente conforme y profesional.",
    testimonial1Author: "— Propietario de Restaurante",
    testimonial2: "El soporte bilingüe era exactamente lo que necesitábamos. Nuestros clientes de habla hispana ahora dejan reseñas tan a menudo como los anglohablantes.",
    testimonial2Author: "— Gerente Minorista",
    testimonial3: "La configuración fue increíblemente rápida. Estuvimos operativos en menos de 48 horas, y los informes semanales son muy útiles.",
    testimonial3Author: "— Proveedor de Servicios",
    packagesTitle: "Elija Su Paquete",
    packagesSubtitle: "Configuración única para solicitudes continuas de reseñas de Google",
    packageStarterTitle: "Starter",
    packageStarterFeature1: "Hasta 100 solicitudes de reseña",
    packageStarterFeature2: "Correos en inglés o español",
    packageStarterFeature3: "Informes resumidos semanales",
    packageStarterFeature4: "Configuración en 48 horas",
    packageStarterBtn: "Comprar Starter",
    packageStandardTitle: "Estándar",
    packageStandardFeature1: "Hasta 500 solicitudes de reseña",
    packageStandardFeature2: "Correos bilingües (EN + ES)",
    packageStandardFeature3: "Informes resumidos semanales",
    packageStandardFeature4: "Plantillas de correo personalizadas",
    packageStandardFeature5: "Configuración en 48 horas",
    packageStandardBtn: "Comprar Estándar",
    packageProTitle: "Rápido/Pro",
    packageProFeature1: "Solicitudes de reseña ilimitadas",
    packageProFeature2: "Correos bilingües (EN + ES)",
    packageProFeature3: "Informes resumidos diarios",
    packageProFeature4: "Plantillas de correo personalizadas",
    packageProFeature5: "Configuración exprés en 24 horas",
    packageProBtn: "Comprar Rápido/Pro",
    howItWorksTitle: "Cómo Funciona",
    howItWorksSubtitle: "Proceso simple para obtener más reseñas de Google",
    step1Title: "Compra + Incorporación",
    step1Description: "Elija su paquete y complete nuestro simple proceso de incorporación de 3 minutos.",
    step2Title: "Enviamos Solicitudes",
    step2Description: "Enviamos solicitudes de reseña personalizadas a sus clientes con recordatorios educados.",
    step3Title: "Obtenga Resultados",
    step3Description: "Reciba informes resumidos semanales con su recuento de nuevas reseñas e información.",
    complianceTitle: "Totalmente Conforme",
    complianceSubtitle: "Seguimos estrictamente las políticas de reseñas de Google",
    complianceNoIncentives: "Sin incentivos",
    complianceNoGating: "Sin filtrar reseñas",
    complianceAllCustomers: "Preguntamos a todos los clientes recientes",
    complianceOptOut: "Opción de exclusión clara en cada correo",
    complianceNote: "Solo usamos listas consentidas proporcionadas por usted. Todos los correos pueden estar en inglés, español o ambos idiomas.",
    complianceGooglePolicy: "Google prohíbe las reseñas incentivadas o filtradas; cumplimos totalmente con todas las políticas.",
    faqTitle: "Preguntas Frecuentes",
    faqSubtitle: "Todo lo que necesita saber sobre nuestro servicio",
    faqQuestion1: "¿Este servicio cumple con las políticas de Google?",
    faqAnswer1: "Sí, seguimos estrictamente las políticas de reseñas de Google. Nunca ofrecemos incentivos por reseñas, no filtramos reseñas (solo preguntamos a clientes felices), e incluimos una opción clara de exclusión en cada correo. Preguntamos a todos los clientes recientes, no solo a aquellos que probablemente dejen reseñas positivas.",
    faqQuestion2: "¿Qué tan rápido puedo comenzar?",
    faqAnswer2: "Nos implementamos dentro de las 48 horas posteriores a que complete el proceso de incorporación. Para nuestro paquete Rápido/Pro, podemos configurar todo dentro de las 24 horas. El proceso de incorporación en sí toma solo unos 3 minutos.",
    faqQuestion3: "¿Qué necesito proporcionar?",
    faqAnswer3: "Necesitará proporcionar su enlace o código QR de reseña de Google, una lista de contactos consentidos de clientes recientes, su dirección de remitente preferida y su logo/tono de marca si desea plantillas de correo personalizadas.",
    faqQuestion4: "¿Cómo se manejan los datos de los clientes?",
    faqAnswer4: "Nos tomamos la privacidad de los datos en serio. La información del cliente se usa solo para enviar solicitudes de reseña y se elimina después de 30 días. Nunca compartimos ni vendemos datos de clientes a terceros.",
    faqQuestion5: "¿Qué dominio de correo se utilizará?",
    faqAnswer5: "Podemos enviar correos desde su dominio o desde nuestro dominio del sistema. Usar su dominio generalmente resulta en tasas de apertura más altas, pero requiere una configuración simple de DNS. Lo guiaremos a través de este proceso durante la incorporación.",
    faqQuestion6: "¿Qué tipo de resultados puedo esperar?",
    faqAnswer6: "Los resultados varían según las relaciones con sus clientes y su industria, pero nuestros clientes generalmente ven un aumento del 20-40% en las reseñas de Google dentro del primer mes. El enfoque bilingüe a menudo produce resultados aún mejores para empresas con clientes de habla hispana.",
    contactTitle: "¿Listo para Comenzar?",
    contactSubtitle: "¿Tiene preguntas? Comuníquese con nuestro equipo",
    contactEmail: "Envíenos un Correo",
    contactOnboarding: "Comenzar Incorporación",
    contactTestNote: "Nota: Los enlaces de Stripe anteriores son solo para fines de prueba. No se realizarán cargos reales.",
    footerAbout: "Sobre Nosotros",
    footerAboutText: "Ayudamos a las empresas a obtener más reseñas de Google a través de solicitudes de correo electrónico conformes y bilingües.",
    footerQuickLinks: "Enlaces Rápidos",
    footerPackages: "Paquetes",
    footerHowItWorks: "Cómo Funciona",
    footerCompliance: "Cumplimiento",
    footerFaq: "Preguntas",
    footerContact: "Contacto",
    footerEmail: "info@reviewsrequestmachine.com",
    footerComplianceNote: "Google prohíbe las reseñas incentivadas o filtradas; cumplimos totalmente."
  }
};

// DOM Elements
const langEn = document.getElementById('lang-en');
const langEs = document.getElementById('lang-es');
const backToTop = document.getElementById('back-to-top');
const faqQuestions = document.querySelectorAll('.faq-question');
const header = document.querySelector('header');

// Initialize language
let currentLang = localStorage.getItem('language') || 'en';
setLanguage(currentLang);

// Language toggle
langEn.addEventListener('click', () => setLanguage('en'));
langEs.addEventListener('click', () => setLanguage('es'));

function setLanguage(lang) {
  currentLang = lang;
  localStorage.setItem('language', lang);

  // Update active button
  if (lang === 'en') {
    langEn.classList.add('active');
    langEs.classList.remove('active');
  } else {
    langEs.classList.add('active');
    langEn.classList.remove('active');
  }

  // Update all translatable elements
  document.querySelectorAll('[data-i18n]').forEach(element => {
    const key = element.getAttribute('data-i18n');
    if (translations[lang] && translations[lang][key]) {
      element.textContent = translations[lang][key];
    }
  });

  // Update HTML lang attribute
  document.documentElement.lang = lang;
}

// Back to top button
window.addEventListener('scroll', () => {
  if (window.pageYOffset > 900) {
    backToTop.classList.add('visible');
  } else {
    backToTop.classList.remove('visible');
  }

  // Shrink header on scroll
  if (window.pageYOffset > 100) {
    header.classList.add('shrink');
  } else {
    header.classList.remove('shrink');
  }
});

backToTop.addEventListener('click', () => {
  window.scrollTo({
    top: 0,
    behavior: 'smooth'
  });
});

// FAQ Accordion
faqQuestions.forEach(question => {
  question.addEventListener('click', () => {
    const answer = question.nextElementSibling;
    const isActive = question.classList.contains('active');

    // Close all FAQs
    faqQuestions.forEach(q => {
      q.classList.remove('active');
      q.setAttribute('aria-expanded', 'false');
      q.nextElementSibling.classList.remove('active');
    });

    // Open clicked FAQ if it wasn't active
    if (!isActive) {
      question.classList.add('active');
      question.setAttribute('aria-expanded', 'true');
      answer.classList.add('active');
    }
  });
});

// Ripple effect for buttons
document.querySelectorAll('.btn').forEach(button => {
  button.addEventListener('click', function(e) {
    const ripple = document.createElement('span');
    ripple.classList.add('ripple');

    const rect = this.getBoundingClientRect();
    const size = Math.max(rect.width, rect.height);
    const x = e.clientX - rect.left - size / 2;
    const y = e.clientY - rect.top - size / 2;

    ripple.style.width = ripple.style.height = size + 'px';
    ripple.style.left = x + 'px';
    ripple.style.top = y + 'px';

    this.appendChild(ripple);

    setTimeout(() => {
      ripple.remove();
    }, 600);

    // Confetti effect for CTA buttons
    if (this.classList.contains('btn-primary') || this.classList.contains('btn-secondary') || this.classList.contains('btn-accent')) {
      createConfetti(e.clientX, e.clientY);
    }
  });
});

// Confetti effect
function createConfetti(x, y) {
  const colors = ['#6366f1', '#8b5cf6', '#ec4899', '#10b981'];
  const confettiCount = 30;

  for (let i = 0; i < confettiCount; i++) {
    const confetti = document.createElement('div');
    confetti.classList.add('confetti');

    const size = Math.random() * 8 + 5;
    const color = colors[Math.floor(Math.random() * colors.length)];
    const angle = Math.random() * 360;
    const velocity = Math.random() * 3 + 2;

    confetti.style.width = size + 'px';
    confetti.style.height = size + 'px';
    confetti.style.backgroundColor = color;
    confetti.style.left = x + 'px';
    confetti.style.top = y + 'px';
    confetti.style.transform = `rotate(${angle}deg)`;

    document.body.appendChild(confetti);

    // Animate confetti
    const animation = confetti.animate([
      { transform: `translate(0, 0) rotate(${angle}deg)`, opacity: 1 },
      { transform: `translate(${(Math.random() - 0.5) * 200}px, ${window.innerHeight}px) rotate(${angle + 360}deg)`, opacity: 0 }
    ], {
      duration: Math.random() * 1000 + 1000,
      easing: 'cubic-bezier(0, .9, .57, 1)'
    });

    animation.onfinish = () => confetti.remove();
  }
}

// Magnetic hover effect for buttons
document.querySelectorAll('.btn').forEach(button => {
  button.addEventListener('mousemove', (e) => {
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

    const rect = button.getBoundingClientRect();
    const x = e.clientX - rect.left - rect.width / 2;
    const y = e.clientY - rect.top - rect.height / 2;

    button.style.transform = `translate(${x * 0.2}px, ${y * 0.2}px)`;
  });

  button.addEventListener('mouseleave', () => {
    button.style.transform = '';
  });
});

// Card tilt effect
document.querySelectorAll('.card').forEach(card => {
  card.addEventListener('mousemove', (e) => {
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;

    const rect = card.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    const centerX = rect.width / 2;
    const centerY = rect.height / 2;
    const rotateX = (y - centerY) / 10;
    const rotateY = (centerX - x) / 10;

    card.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg)`;
  });

  card.addEventListener('mouseleave', () => {
    card.style.transform = '';
  });
});

// Initialize Lottie animation
const heroLottie = lottie.loadAnimation({
  container: document.getElementById('hero-lottie'),
  renderer: 'svg',
  loop: true,
  autoplay: true,
  path: 'https://assets2.lottiefiles.com/packages/lf20_DMgKk1.json'
});

// GSAP Animations
gsap.registerPlugin(ScrollTrigger);

// Parallax effect for hero background
if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
  gsap.to('.hero-bg', {
    yPercent: 50,
    ease: 'none',
    scrollTrigger: {
      trigger: '.hero',
      start: 'top bottom',
      end: 'bottom top',
      scrub: true
    }
  });
}

// Reveal animations
gsap.utils.toArray('section').forEach(section => {
  gsap.fromTo(section.children,
    { y: 50, opacity: 0 },
    {
      y: 0,
      opacity: 1,
      duration: 1,
      stagger: 0.2,
      scrollTrigger: {
        trigger: section,
        start: 'top 80%',
        toggleActions: 'play none none none'
      }
    }
  );
});

// Step line animation (note: GSAP can't target pseudo-elements directly in some cases)
gsap.fromTo('.steps::before',
  { scaleX: 0 },
  {
    scaleX: 1,
    duration: 1,
    scrollTrigger: {
      trigger: '.steps',
      start: 'top 80%',
      toggleActions: 'play none none none'
    }
  }
);

// Testimonial cards animation
gsap.utils.toArray('.testimonial').forEach((card, i) => {
  gsap.fromTo(card,
    { x: i % 2 === 0 ? -50 : 50, opacity: 0 },
    {
      x: 0,
      opacity: 1,
      duration: 0.8,
      delay: i * 0.1,
      scrollTrigger: {
        trigger: card,
        start: 'top 80%',
        toggleActions: 'play none none none'
      }
    }
  );
});

// Pricing cards animation
gsap.utils.toArray('.pricing-card').forEach((card, i) => {
  gsap.fromTo(card,
    { y: 50, opacity: 0 },
    {
      y: 0,
      opacity: 1,
      duration: 0.8,
      delay: i * 0.1,
      scrollTrigger: {
        trigger: card,
        start: 'top 80%',
        toggleActions: 'play none none none'
      }
    }
  );
});

// FAQ items animation
gsap.utils.toArray('.faq-item').forEach((item, i) => {
  gsap.fromTo(item,
    { y: 30, opacity: 0 },
    {
      y: 0,
      opacity: 1,
      duration: 0.6,
      delay: i * 0.05,
      scrollTrigger: {
        trigger: item,
        start: 'top 90%',
        toggleActions: 'play none none none'
      }
    }
  );
});
